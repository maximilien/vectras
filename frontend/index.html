<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Vectras</title>
    <link rel="stylesheet" href="/static/styles.css" />
    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  </head>
  <body>
    <div id="app">
      <header class="topbar">
        <button id="hamburger" aria-label="menu">‚ò∞</button>
        <div class="brand">Vectras</div>
        <div class="spacer"></div>
        <button id="settings" aria-label="settings">‚öôÔ∏è</button>
        <div id="hamburger-menu" class="menu" aria-hidden="true" role="menu">
          <button id="menu-new" class="menu-item" role="menuitem">‚ûï New chat</button>
          <button id="menu-clear" class="menu-item" role="menuitem">üóëÔ∏è Clear chats</button>
          <hr />
          <button id="menu-settings" class="menu-item" role="menuitem">‚öôÔ∏è Settings</button>
        </div>
      </header>

      <div class="layout" id="layout">
        <aside class="left-pane" id="left-pane">
          <div class="pane-header">
            <button id="left-toggle" class="collapse-btn" aria-controls="left-pane" aria-expanded="true" title="Collapse chats">‚Äπ</button>
            <span>Chats</span>
            <button id="new-chat-btn" class="new-chat-btn" title="New chat">+</button>
          </div>
          <ul id="chat-list" class="list"></ul>
        </aside>

        <main class="center-pane">
          <div id="agent-card" class="agent-card hidden">
            <div class="agent-card-header">
              <div class="agent-card-title">
                <div class="agent-header">
                  <strong id="agent-name">Agent Name</strong>
                  <span class="status-badge active" id="agent-status">Active</span>
                </div>
              </div>
              <button id="agent-card-toggle" class="collapse-btn" aria-controls="agent-card-content" aria-expanded="true" title="Collapse agent details">‚åÉ</button>
            </div>
            <div id="agent-card-content" class="agent-card-content">
              <!-- Agent card content will be inserted here by JavaScript -->
            </div>
          </div>
          <div id="chat" class="chat"></div>
          <form id="composer" class="composer">
            <button type="button" id="recent-btn" class="recent-btn" title="Recent messages">üïí</button>
            <input id="input" type="text" placeholder="Type a message..." autocomplete="off" />
            <button type="submit">Send</button>
          </form>
        </main>

        <!-- Recent Messages Popup -->
        <div id="recent-panel" class="recent-panel" aria-hidden="true">
          <div class="recent-header">
            <strong>Recent Messages</strong>
            <button id="recent-close" aria-label="close">‚úï</button>
          </div>
          <div class="recent-body">
            <div class="recent-messages" id="recent-messages">
              <!-- Recent messages will be populated here -->
            </div>
            <div class="recent-defaults">
              <h4>Quick Actions</h4>
              <div class="default-queries" id="default-queries">
                <!-- Default queries will be populated here -->
              </div>
            </div>
          </div>
        </div>

        <aside class="right-pane" id="right-pane">
          <div class="pane-header">
            <span>Agents</span>
            <button id="right-toggle" class="collapse-btn" aria-controls="right-pane" aria-expanded="true" title="Collapse agents">‚Ä∫</button>
          </div>
          <ul id="agent-list" class="list"></ul>
        </aside>

        <!-- Resize handles -->
        <div id="left-resize" class="resize-handle left"></div>
        <div id="right-resize" class="resize-handle right"></div>
      </div>

      <!-- Floating edge handles to reopen collapsed panes -->
      <button id="left-handle" class="edge-handle" aria-label="Open chats" title="Open chats">‚Ä∫</button>
      <button id="right-handle" class="edge-handle right" aria-label="Open agents" title="Open agents">‚Äπ</button>

      <!-- System Status Panel (for gear wheel button) -->
      <div id="system-status-panel" class="settings-panel system-status-panel" aria-hidden="true">
        <div class="settings-header">
          <strong>System Status</strong>
          <button id="system-status-close" aria-label="close">‚úï</button>
        </div>
        <div class="settings-body">
          <div class="status-section">
            <h3>üñ•Ô∏è Core Services</h3>
            <div class="service-group" id="core-services-status">
              <div class="service-item">
                <span class="service-name">üñ•Ô∏è UI</span>
                <span class="service-url">localhost:8120</span>
                <span class="service-status" data-service="ui">‚è≥ Checking...</span>
              </div>
              <div class="service-item">
                <span class="service-name">üîå API</span>
                <span class="service-url">localhost:8121</span>
                <span class="service-status" data-service="api">‚è≥ Checking...</span>
              </div>
              <div class="service-item">
                <span class="service-name">üîó MCP</span>
                <span class="service-url">localhost:8122</span>
                <span class="service-status" data-service="mcp">‚è≥ Checking...</span>
              </div>
            </div>
          </div>

          <div class="status-section">
            <h3>ü§ñ Agents</h3>
            <div class="service-group" id="agents-status">
              <div class="service-item">
                <span class="service-name">üëë Supervisor</span>
                <span class="service-url">localhost:8123</span>
                <span class="service-status" data-service="supervisor">‚è≥ Checking...</span>
              </div>
              <div class="service-item">
                <span class="service-name">üìä Logging Monitor</span>
                <span class="service-url">localhost:8124</span>
                <span class="service-status" data-service="logging-monitor">‚è≥ Checking...</span>
              </div>
              <div class="service-item">
                <span class="service-name">üîß Coding</span>
                <span class="service-url">localhost:8125</span>
                <span class="service-status" data-service="coding">‚è≥ Checking...</span>
              </div>
              <div class="service-item">
                <span class="service-name">‚úÖ Linting</span>
                <span class="service-url">localhost:8127</span>
                <span class="service-status" data-service="linting">‚è≥ Checking...</span>
              </div>
              <div class="service-item">
                <span class="service-name">üß™ Testing</span>
                <span class="service-url">localhost:8126</span>
                <span class="service-status" data-service="testing">‚è≥ Checking...</span>
              </div>
              <div class="service-item">
                <span class="service-name">üêô GitHub</span>
                <span class="service-url">localhost:8128</span>
                <span class="service-status" data-service="github">‚è≥ Checking...</span>
              </div>
            </div>
          </div>

          <div class="status-section">
            <h3>üìä System Info</h3>
            <div class="system-info">
              <div class="info-item">
                <span class="info-label">Total Services:</span>
                <span class="info-value" id="total-services-status">9</span>
              </div>
              <div class="info-item">
                <span class="info-label">Healthy:</span>
                <span class="info-value" id="healthy-count-status">0</span>
              </div>
              <div class="info-item">
                <span class="info-label">Last Check:</span>
                <span class="info-value" id="last-check-status">Never</span>
              </div>
            </div>
            <button id="refresh-status-system" class="refresh-btn">üîÑ Refresh Status</button>
          </div>
        </div>
      </div>

      <!-- Vectras Settings Panel (for hamburger menu) -->
      <div id="vectras-settings-panel" class="settings-panel vectras-settings-panel" aria-hidden="true">
        <div class="settings-header">
          <strong>Vectras Settings</strong>
          <button id="vectras-settings-close" aria-label="close">‚úï</button>
        </div>
        <div class="settings-body">
          <!-- Global Settings Section -->
          <div class="config-section">
            <h3>üåê Global Settings</h3>
            <div class="config-group" id="global-settings">
              <div class="loading-indicator">Loading global settings...</div>
            </div>
          </div>

          <!-- Default Queries Section -->
          <div class="config-section">
            <h3>üîç Default Queries</h3>
            <div class="config-group" id="default-queries-config">
              <div class="loading-indicator">Loading default queries...</div>
            </div>
          </div>

          <!-- Agents Section -->
          <div class="config-section">
            <h3>ü§ñ Agents Configuration</h3>
            <div class="agents-config-container">
              <div class="agents-dropdown-container">
                <label for="agent-selector">Select Agent:</label>
                <select id="agent-selector" class="agent-selector">
                  <option value="">Choose an agent...</option>
                </select>
              </div>
              <div class="config-group" id="agent-config">
                <div class="no-agent-selected">Select an agent from the dropdown above to view its configuration</div>
              </div>
            </div>
          </div>

          <!-- System Status Section (collapsed by default) -->
          <div class="config-section">
            <div class="section-header" id="system-status-header">
              <h3>üñ•Ô∏è System Status</h3>
              <button class="toggle-section" id="toggle-system-status" aria-expanded="false">‚åÑ</button>
            </div>
            <div class="config-group collapsed" id="system-status-content">
              <div class="status-section">
                <h4>üñ•Ô∏è Core Services</h4>
                <div class="service-group" id="core-services">
                  <div class="service-item">
                    <span class="service-name">üñ•Ô∏è UI</span>
                    <span class="service-url">localhost:8120</span>
                    <span class="service-status" data-service="ui">‚è≥ Checking...</span>
                  </div>
                  <div class="service-item">
                    <span class="service-name">üîå API</span>
                    <span class="service-url">localhost:8121</span>
                    <span class="service-status" data-service="api">‚è≥ Checking...</span>
                  </div>
                  <div class="service-item">
                    <span class="service-name">üîó MCP</span>
                    <span class="service-url">localhost:8122</span>
                    <span class="service-status" data-service="mcp">‚è≥ Checking...</span>
                  </div>
                </div>
              </div>

              <div class="status-section">
                <h4>ü§ñ Agents</h4>
                <div class="service-group" id="agents">
                  <div class="service-item">
                    <span class="service-name">üëë Supervisor</span>
                    <span class="service-url">localhost:8123</span>
                    <span class="service-status" data-service="supervisor">‚è≥ Checking...</span>
                  </div>
                  <div class="service-item">
                    <span class="service-name">üìä Logging Monitor</span>
                    <span class="service-url">localhost:8124</span>
                    <span class="service-status" data-service="logging-monitor">‚è≥ Checking...</span>
                  </div>
                  <div class="service-item">
                    <span class="service-name">üîß Coding</span>
                    <span class="service-url">localhost:8125</span>
                    <span class="service-status" data-service="coding">‚è≥ Checking...</span>
                  </div>
                  <div class="service-item">
                    <span class="service-name">‚úÖ Linting</span>
                    <span class="service-url">localhost:8127</span>
                    <span class="service-status" data-service="linting">‚è≥ Checking...</span>
                  </div>
                  <div class="service-item">
                    <span class="service-name">üß™ Testing</span>
                    <span class="service-url">localhost:8126</span>
                    <span class="service-status" data-service="testing">‚è≥ Checking...</span>
                  </div>
                  <div class="service-item">
                    <span class="service-name">üêô GitHub</span>
                    <span class="service-url">localhost:8128</span>
                    <span class="service-status" data-service="github">‚è≥ Checking...</span>
                  </div>
                </div>
              </div>

              <div class="status-section">
                <h4>üìä System Info</h4>
                <div class="system-info">
                  <div class="info-item">
                    <span class="info-label">Total Services:</span>
                    <span class="info-value" id="total-services">9</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Healthy:</span>
                    <span class="info-value" id="healthy-count">0</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Last Check:</span>
                    <span class="info-value" id="last-check">Never</span>
                  </div>
                </div>
                <button id="refresh-status" class="refresh-btn">üîÑ Refresh Status</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="/static/app.js"></script>
  </body>
  </html>


